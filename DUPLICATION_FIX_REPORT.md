# ๐ง ุชูุฑูุฑ ุฅุตูุงุญ ูุดููุฉ ุงูุชูุฑุงุฑ ูู ุงูุชุญููู

## ๐ฏ **ุงููุดููุฉ ุงูููุชุดูุฉ:**
ุงููุณุชุฎุฏู ูุงุญุธ ุฃู ุงูุจุญุซ ูุงูุชุญููู ูุญุฏุซ **ูุฑุชูู** - ูุฑุฉ ูุงุดูุฉ ููุฑุฉ ูุงุฌุญุฉ.

---

## ๐ **ุงูุชุดุฎูุต:**

### **ุงูุณุจุจ ุงูุฌุฐุฑู:**
ูุงู ููุงู **3 ูุนุงูุฌุงุช ูููุตูุฉ** ููุจุญุซ ุชุนูู ูู ููุณ ุงูููุช:

#### **1. ูุนุงูุฌ ูู `telethon_client.py`:**
```python
@self.bot_client.on(events.NewMessage(pattern=r'(?i)(song|/song|ุจุญุซ|ููุช)'))
async def download_handler(event):
    from ZeMusic.plugins.play.download import smart_download_handler
    await smart_download_handler(event)
```

#### **2. ูุนุงูุฌ ูู `handlers_registry.py`:**
```python
from ZeMusic.plugins.play.download import handle_search_messages
bot_client.add_event_handler(handle_search_messages, events.NewMessage)
```

#### **3. ุฏุงูุฉ `handle_search_messages` ุชุณุชุฏุนู:**
```python
async def handle_search_messages(event):
    # ูุญุต ุฃูุฑ ุงูุจุญุซ
    if is_search_command:
        await smart_download_handler(event)  # ุงุณุชุฏุนุงุก ููุฑุฑ!
```

### **ุงููุชูุฌุฉ:**
- **ูุนุงูุฌ 1:** ูุณุชุฏุนู `smart_download_handler` ูุจุงุดุฑุฉ
- **ูุนุงูุฌ 2:** ูุณุชุฏุนู `handle_search_messages` ุงูุชู ุชุณุชุฏุนู `smart_download_handler`
- **ุงููุชูุฌุฉ:** ุชุดุบูู `smart_download_handler` **ูุฑุชูู** ููู ุฑุณุงูุฉ ุจุญุซ!

---

## โ **ุงูุญู ุงููุทุจู:**

### **1. ุฅุฒุงูุฉ ุงููุนุงูุฌ ุงูููุฑุฑ ูู `telethon_client.py`:**
```python
# ุชู ุชุนุทูู ูุฐุง ุงููุนุงูุฌ ูุชุฌูุจ ุงูุชูุฑุงุฑ
# @self.bot_client.on(events.NewMessage(pattern=r'(?i)(song|/song|ุจุญุซ|ููุช)'))
# async def download_handler(event): ...
```

### **2. ุชุญุฏูุซ `handlers_registry.py` ููุงุณุชุฏุนุงุก ุงููุจุงุดุฑ:**
```python
# ูุจู: ุงุณุชุฏุนุงุก handle_search_messages (ุทุจูุฉ ุฅุถุงููุฉ)
from ZeMusic.plugins.play.download import handle_search_messages

# ุจุนุฏ: ุงุณุชุฏุนุงุก smart_download_handler ูุจุงุดุฑุฉ
from ZeMusic.plugins.play.download import smart_download_handler
bot_client.add_event_handler(smart_download_handler, events.NewMessage)
```

### **3. ุฏูุฌ ููุทู ุงูููุชุฑุฉ ูู `smart_download_handler`:**
```python
async def smart_download_handler(event):
    # ูุญุต ุฃู ูุฐู ุฑุณุงูุฉ ุตุญูุญุฉ
    if not hasattr(event, 'message') or not event.message.text:
        return
    
    # ูุญุต ุงูุชูููุช (ุชุฌูุจ ุงูุฑุณุงุฆู ุงููุฏููุฉ)
    if (now - message_date).total_seconds() > 30:
        return
    
    # ููุชุฑุฉ ุฃูุงูุฑ ุงูุจุญุซ
    text = event.message.text.lower().strip()
    search_commands = ["ุจุญุซ ", "/song ", "song ", "ููุช "]
    
    if not any(text.startswith(cmd) for cmd in search_commands):
        if " ุจุญุซ " not in text and text != "ุจุญุซ":
            return  # ููุณ ุฃูุฑ ุจุญุซ - ุชููู ููุง
    
    # ุจุงูู ููุทู ุงูุชุญููู...
```

### **4. ุญุฐู ุงูุฏุงูุฉ ุงูููุฑุฑุฉ:**
```python
# ุชู ุญุฐู handle_search_messages ุจุงููุงูู
# ุชู ุฏูุฌ ููุทููุง ูู smart_download_handler
```

---

## ๐ **ุงููุชูุฌุฉ:**

### **ูุจู ุงูุฅุตูุงุญ:**
```
ุฑุณุงูุฉ ุจุญุซ โ ูุนุงูุฌ 1 โ smart_download_handler (ุฃูู ูุญุงููุฉ)
             โ
             ูุนุงูุฌ 2 โ handle_search_messages โ smart_download_handler (ุซุงูู ูุญุงููุฉ)
```
**ุงููุชูุฌุฉ:** ุชุญููู ููุฑุฑ + ุฑุณุงุฆู ูุชุนุฏุฏุฉ

### **ุจุนุฏ ุงูุฅุตูุงุญ:**
```
ุฑุณุงูุฉ ุจุญุซ โ ูุนุงูุฌ ูุงุญุฏ โ smart_download_handler (ูุญุงููุฉ ูุงุญุฏุฉ ููุท)
```
**ุงููุชูุฌุฉ:** ุชุญููู ูุงุญุฏ + ุฑุณุงูุฉ ูุงุญุฏุฉ

---

## ๐ฏ **ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ:**

### **1. ููุชุฑุฉ ุฃูุถู ููุฑุณุงุฆู:**
- ูุญุต ุงูุชูููุช ูุชุฌูุจ ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุงููุฏููุฉ
- ูุญุต ุตุญุฉ ุจููุฉ ุงูุฑุณุงูุฉ
- ููุชุฑุฉ ุฏูููุฉ ูุฃูุงูุฑ ุงูุจุญุซ

### **2. ุชุญุณูู ุงูุฃุฏุงุก:**
- ุฅุฒุงูุฉ ุงูุทุจูุงุช ุงูุฅุถุงููุฉ
- ุงุณุชุฏุนุงุก ูุจุงุดุฑ ูููุนุงูุฌ
- ุชูููู ุงุณุชููุงู ุงูุฐุงูุฑุฉ

### **3. ุณูููุฉ ุงูุตูุงูุฉ:**
- ููุฏ ุฃูุซุฑ ูุถูุญุงู
- ููุทู ููุญุฏ ูู ููุงู ูุงุญุฏ
- ุชูููู ุงูุชุนููุฏ

---

## โ **ุงูุชุฃููุฏ ูู ุงูุฅุตูุงุญ:**

### **ูู ุงูุณุฌูุงุช:**
```
[INFO] - โ ุชู ุชุณุฌูู ูุนุงูุฌ ุงูุจุญุซ ุงููุจุงุดุฑ
```
ุจุฏูุงู ูู:
```
[INFO] - โ ุชู ุชุณุฌูู ูุนุงูุฌ ุงูุจุญุซ  # ุงููุนุงูุฌ ุงููุฏูู
```

### **ุงูุณููู ุงููุชููุน ุงูุขู:**
1. ุงููุณุชุฎุฏู ูุฑุณู: `ุจุญุซ ุฃุบููุฉ`
2. ูุนุงูุฌ ูุงุญุฏ ููุท ูุชููู ุงูุฑุณุงูุฉ
3. `smart_download_handler` ููุณุชุฏุนู ูุฑุฉ ูุงุญุฏุฉ
4. ุงูุจุญุซ ูุงูุชุญููู ูุญุฏุซ ูุฑุฉ ูุงุญุฏุฉ
5. ุฑุณุงูุฉ ูุงุญุฏุฉ ูููุณุชุฎุฏู (ูุฌุญ ุฃู ูุดู)

---

## ๐ **ุงูุญุงูุฉ ุงูุญุงููุฉ:**

โ **ุงูุจูุช ูุนูู ูุน ูุนุงูุฌ ูุงุญุฏ ููุท**  
โ **ูุง ุชูุฌุฏ ุงุณุชุฏุนุงุกุงุช ููุฑุฑุฉ**  
โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณููุฉ**  
โ **ููุฏ ุฃูุซุฑ ููุงุกุฉ**  

---

**๐ ุชู ุฅุตูุงุญ ูุดููุฉ ุงูุชูุฑุงุฑ ุจูุฌุงุญ!**

**ุงูุขู ุฌุฑูุจ ุงูุจุญุซ - ุณุชุญุตู ุนูู ุฑุณุงูุฉ ูุงุญุฏุฉ ููุท!** ๐ต